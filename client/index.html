<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://js.arcgis.com/4.13/esri/css/main.css">
    <style>
        html, body, #app { padding: 0; margin: 0; height: 100%; width: 100%; }
    </style>
    <script>
        var dojoConfig = {
            async: true,
            packages: [
                { name: 'local', location: location.pathname.replace(/\/[^/]*$/, '') + '/local' },
                { name: 'vue', location: 'https://unpkg.com/vue/dist/', main: 'vue' }
            ]
        }
    </script>
    <script src="https://js.arcgis.com/4.13/"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>
        require(['local/app', 'local/featuresManager'], function (app, fm) {
            window.getData = function (collection_name) {
                $.ajax({
                    method: 'post',
                    url: app.getURL(),
                    contentType: "application/json",
                    dataType: "json",
                    data: JSON.stringify({
                        Method: 'get_all',
                        Dataset: "electric",
                        Collection: `${collection_name}`
                    }),
                    success: (data) => {
                        let features = fm.preparedFeatures(data)
                        layer = app.getMap().findLayerById(collection_name)
                        if (layer) {
                            layer.graphics.addMany(features)
                            let first = layer.graphics.getItemAt(0)
                            if (first) app.getView().goTo(first)
                        }
                    },
                    error: (error) => {
                        console.log(error)
                    }
                })
            }
        })
    </script>
</head>
<body>
    <div id="app"></div>
</body>
</html>